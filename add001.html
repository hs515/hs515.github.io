<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='utf-8' />
    <title>
        Add 001!
    </title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="js/mathbox.js"></script>
    <script src="js/mainbody.js"></script>
    <script>
        let number = 10;
        let numberOfCorrect = 0;
        let questions = new Array();

        function createNext() {
            const n1 = randomNumberLessThan(10, "linear");
            const n2 = randomNumberLessThan(10, "sqrt");
            questions[questions.length] = {
                first: n1,
                second: n2,
                answer: undefined
            };
            document.querySelector('#question_n1').innerHTML = n1;
            document.querySelector('#question_n2').innerHTML = n2;
        }

        function saveAnswer() {
            if (document.querySelector('#question_answer').value.length > 0) {
                const cur = questions[questions.length - 1];
                cur.answer = parseInt(document.querySelector('#question_answer').value);
                const li = document.createElement('p');
                let result = (cur.first * cur.second === cur.answer);
                numberOfCorrect += result;
                let mark = result ? "<span class=\"badge badge-success\">T</span>" : "<span class=\"badge badge-danger\">F</span>";
                let danger = result ? "<div class=\"alert alert-success\" role=\"alert\">" : "<div class=\"alert alert-danger\" role=\"alert\">";

                li.innerHTML = `${danger} ${mark} ${cur.first} x ${cur.second} = ${cur.answer} </div>`;
                document.querySelector('#question_list').prepend(li);

                document.querySelector('#question_answer').value = "";
                createNext();

                document.querySelector('#question_summary').innerHTML = `Answers ${numberOfCorrect}/${questions.length - 1}`
                document.getElementById("question_message").hidden = true;
            } else {
                document.getElementById("question_message").innerHTML = "Please input your answer then submit.";
                document.getElementById("question_message").hidden = false;
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            initializePageBody();
            document.querySelector('#question_submit').disabled = true;
            document.getElementById("question_message").hidden = true;

            document.querySelector('#question_answer').onkeyup = () => {
                if (document.querySelector('#question_answer').value.length > 0) {
                    document.querySelector('#question_submit').disabled = false;
                } else {
                    document.querySelector('#question_submit').disabled = true;
                }
            }

            document.querySelector('form').onsubmit = () => {
                const answer = document.querySelector('#question_answer').value;
                console.log(answer);
                saveAnswer();

                // Stop submitting form
                return false;
            }

            createNext();
        })
    </script>
</head>

<body id="page_body">
</body>

</html>